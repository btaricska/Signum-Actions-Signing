  echo "üîë Listing all private keys in slot..."
  docker exec $CONTAINER_NAME pkcs11-tool --module "$MODULE" --slot "$SLOT" --login --list-objects --type privkey
  
  echo "üîë Extracting first private key..."
  KEY_INFO=$(docker exec $CONTAINER_NAME pkcs11-tool --module "$MODULE" --slot "$SLOT" --login --list-objects --type privkey | head -n5)
  if [ -z "$KEY_INFO" ]; then
    echo "‚ùå No private key found in slot $SLOT"
    exit 1
  fi
  
  KEY_ID=$(echo "$KEY_INFO" | awk '/ID:/ {print $2; exit}')
  KEY_LABEL=$(echo "$KEY_INFO" | awk '/Label:/ {print $2; exit}')
  echo "‚úÖ Using private key ID: $KEY_ID, Label: $KEY_LABEL"
  
  echo "‚úçÔ∏è Signing JSON file..."
  docker exec $CONTAINER_NAME pkcs11-tool \
    --module "$MODULE" \
    --slot "$SLOT" \
    --login \
    --sign \
    --input-file "$CONTAINER_FILE" \
    --output-file "$CONTAINER_SIG" \
    --id "$KEY_ID"
  
  echo "üì¶ Verifying signature..."
  docker exec $CONTAINER_NAME test -f "$CONTAINER_SIG" || { echo "‚ùå Signature file was not created"; exit 1; }
  
  echo "üì• Copying signature to runner workspace..."
  cp "$FILES_DIR/file.json.sig" .
  
  echo "‚úÖ Signing completed successfully"
  shell: /usr/bin/bash --noprofile --norc -e -o pipefail {0}
  env:
    SIGNUM_AGENT_IMAGE: keyfactor.jfrog.io/dev-oci/signum-agent:4.20.1
    FILES_DIR: filestosign
    CONTAINER_NAME: signum-agent
    DOCKER_CONFIG: /home/runner/work/Signum-Actions-Signing/Signum-Actions-Signing/.docker
üîé Verifying input file exists in container...
‚úÖ Input file verified
üîç Detecting first initialized token slot...
‚ùå No slot with an initialized token found
Error: Process completed with exit code 1.
